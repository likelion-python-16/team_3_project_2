{% extends 'base.html' %}
{% load static %}

{% block title %}지역 인구 현황{% endblock %}

{% block content %}
<div class="container main">
    <div class="card">
        <div class="card__head">
            <h3>지역 인구 현황 <span class="tag">전체 {{ populations|length }}개 지역</span></h3>
        </div>
        
        {% if populations %}
            <div class="grid-2" style="gap: 16px; margin-top: 16px;">
                {% for population in populations %}
                <div class="card">
                    <div class="card__head">
                        <h4>지역 #{{ population.rp_key }}</h4>
                        <span class="chip">{{ population.traffic_level }}</span>
                    </div>
                    
                    <div class="grid-2" style="margin-top: 12px;">
                        <div class="stat">
                            <div>
                                <div class="k">총 인구</div>
                                <div class="v">{{ population.total_population|floatformat:0 }}명</div>
                            </div>
                        </div>
                        <div class="stat">
                            <div>
                                <div class="k">연령별 인구</div>
                                <div class="v">{{ population.population_per_ages|floatformat:0 }}명</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="grid-2" style="margin-top: 8px;">
                        <div class="stat">
                            <div>
                                <div class="k">평균 소득</div>
                                <div class="v up">{{ population.income_avg|floatformat:0 }}원</div>
                            </div>
                        </div>
                        <div class="stat">
                            <div>
                                <div class="k">평균 임대료</div>
                                <div class="v">{{ population.rent_avg|floatformat:0 }}원</div>
                            </div>
                        </div>
                    </div>
                    
                    {% if population.cafes.all %}
                    <div style="margin-top: 12px;">
                        <small class="muted">카페 {{ population.cafes.count }}개</small>
                        <div style="margin-top: 4px;">
                            {% for cafe in population.cafes.all|slice:":3" %}
                                <span class="chip" style="margin-right: 4px;">{{ cafe.name }}</span>
                            {% endfor %}
                            {% if population.cafes.count > 3 %}
                                <span class="muted">외 {{ population.cafes.count|add:"-3" }}개</span>
                            {% endif %}
                        </div>
                    </div>
                    {% endif %}
                </div>
                {% endfor %}
            </div>
        {% else %}
            <div class="panel panel--notice">
                <span>지역 인구 데이터가 없습니다.</span>
            </div>
        {% endif %}
    </div>
</div>
{% endblock %}