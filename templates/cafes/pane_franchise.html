{% load static %}
<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>í”„ëœì°¨ì´ì¦ˆ ë¶„ì„</title>
  <link rel="stylesheet" href="{% static 'css/styles.css' %}">
  <style>
    /* KPI í´ë¦­ ê°€ëŠ¥ ìŠ¤íƒ€ì¼ */
    .kpi .v {
      cursor: pointer;
      transition: all 0.2s ease;
      border-radius: 4px;
      padding: 2px 4px;
    }
    
    .kpi .v:hover {
      background-color: #f3f4f6;
      transform: scale(1.05);
    }
    
    /* ëª¨ë‹¬ ì˜¤ë²„ë ˆì´ */
    .analysis-modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      display: none;
      z-index: 1000;
      align-items: center;
      justify-content: center;
    }
    
    .analysis-modal-overlay.active {
      display: flex;
    }
    
    /* ëª¨ë‹¬ ì»¨í…Œì´ë„ˆ */
    .analysis-modal {
      background: white;
      border-radius: 12px;
      width: 90%;
      max-width: 800px;
      max-height: 90vh;
      overflow-y: auto;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
      animation: modalSlideIn 0.3s ease-out;
    }
    
    @keyframes modalSlideIn {
      from {
        opacity: 0;
        transform: translateY(-50px) scale(0.9);
      }
      to {
        opacity: 1;
        transform: translateY(0) scale(1);
      }
    }
    
    /* ëª¨ë‹¬ í—¤ë” */
    .analysis-modal-header {
      background: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%);
      color: white;
      padding: 20px 24px;
      border-radius: 12px 12px 0 0;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .analysis-modal-title {
      font-size: 20px;
      font-weight: bold;
      margin: 0;
    }
    
    .analysis-modal-close {
      background: none;
      border: none;
      color: white;
      font-size: 24px;
      cursor: pointer;
      padding: 0;
      width: 30px;
      height: 30px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 50%;
      transition: background 0.2s ease;
    }
    
    .analysis-modal-close:hover {
      background: rgba(255, 255, 255, 0.2);
    }
    
    /* ëª¨ë‹¬ ë‚´ìš© */
    .analysis-modal-content {
      padding: 24px;
    }
    
    /* í”¼ë“œ ì¹´ë“œ ìŠ¤íƒ€ì¼ */
    .feed-card {
      background: white;
      border-radius: 12px;
      padding: 24px;
      margin-bottom: 24px;
      box-shadow: 0 2px 12px rgba(0, 0, 0, 0.1);
      border-left: 4px solid #3b82f6;
    }
    
    .feed-card h3 {
      margin: 0 0 12px 0;
      color: #1f2937;
    }
    
    .feed-meta {
      color: #6b7280;
      font-size: 14px;
      margin-bottom: 16px;
    }
    
    .feed-content {
      color: #374151;
      line-height: 1.6;
      margin-bottom: 16px;
    }
    
    .highlight-stat {
      background: #f3f4f6;
      border-radius: 8px;
      padding: 16px;
      margin: 16px 0;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .stat-label {
      font-weight: 500;
      color: #374151;
    }
    
    .stat-value {
      font-size: 18px;
      font-weight: bold;
      color: #059669;
    }
    
    .stat-value.warning {
      color: #d97706;
    }
    
    .stat-value.danger {
      color: #dc2626;
    }
    
    .trending-list {
      list-style: none;
      padding: 0;
      margin: 0;
    }
    
    .trending-list li {
      padding: 12px 0;
      border-bottom: 1px solid #e5e7eb;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .trending-list li:last-child {
      border-bottom: none;
    }
    
    .trend-up {
      color: #059669;
    }
    
    .trend-down {
      color: #dc2626;
    }
    
    /* ë¡œë”© ìŠ¤í”¼ë„ˆ */
    .loading-spinner {
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 40px;
    }
    
    .spinner {
      width: 40px;
      height: 40px;
      border: 4px solid #f3f4f6;
      border-top: 4px solid #3b82f6;
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }
    
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
  </style>
</head>
<body>
  <div class="card tab-pane" id="pane-franchise">
    <h3 id="franchise-title">{{ selected_region }} í”„ëœì°¨ì´ì¦ˆë³„ ë¶„ì„</h3>
    <div class="grid-4 kpi-grid">
      <div class="kpi"><div class="t">ì¹´í˜ ìˆ˜</div><div class="v">{{ total_count }}</div><div class="s">í•„í„°ë§ëœ ê²°ê³¼</div></div>
      <div class="kpi"><div class="t">í”„ëœì°¨ì´ì¦ˆ</div><div class="v">{{ franchise_count }}</div><div class="s">ê°œì¸ ì¹´í˜ {{ individual_count }}ê°œ</div></div>
      <div class="kpi"><div class="t">ë§¤ì¶œì•¡</div><div class="v">{{ total_sales }}ë§Œì›</div><div class="s">ì¶”ì • ë§¤ì¶œ</div></div>
      <div class="kpi"><div class="t">í‰ê·  ì„±ì¥ë¥ </div><div class="v up">{{ avg_growth_rate }}</div></div>
    </div>

    <div class="bars">
      {% for stat in franchise_stats %}
        {% if stat.franchise_type %}
        <div class="row">
          <div class="brand">{{ stat.franchise_type }}</div>
          <div class="bar"><span style="width:{% widthratio stat.count franchise_stats.0.count 100 %}%"></span></div>
          <div class="bar-meta">{{ stat.count }}ê°œ ë§¤ì¥ Â· ì¶”ì • {{ stat.estimated_sales }}ë§Œì›</div>
        </div>
        {% endif %}
      {% empty %}
        <div class="row"><div class="brand">í•„í„° ì¡°ê±´ì— ë§ëŠ” í”„ëœì°¨ì´ì¦ˆê°€ ì—†ìŠµë‹ˆë‹¤</div></div>
      {% endfor %}
    </div>

    <div class="card" style="margin-top:12px">
      <h3>ìœ„í—˜ë„ ë¶„ì„</h3>
      <div class="risk-grid">
        <div class="risk ok"><div class="n">{{ safe_franchises }}</div><div class="muted">ì•ˆì • í”„ëœì°¨ì´ì¦ˆ</div></div>
        <div class="risk warn"><div class="n">{{ warning_franchises }}</div><div class="muted">ì£¼ì˜ í”„ëœì°¨ì´ì¦ˆ</div></div>
        <div class="risk bad"><div class="n">{{ risk_franchises }}</div><div class="muted">ìœ„í—˜ í”„ëœì°¨ì´ì¦ˆ</div></div>
      </div>
    </div>
  </div>

  <!-- ë¶„ì„ ëª¨ë‹¬ -->
  <div class="analysis-modal-overlay" id="analysisModal">
    <div class="analysis-modal">
      <div class="analysis-modal-header">
        <h2 class="analysis-modal-title" id="modalTitle">ìƒì„¸ ë¶„ì„</h2>
        <button class="analysis-modal-close" onclick="closeAnalysisModal()">&times;</button>
      </div>
      <div class="analysis-modal-content" id="modalContent">
        <div class="loading-spinner">
          <div class="spinner"></div>
        </div>
      </div>
    </div>
  </div>
</body>
<script type="text/javascript">
  // URL íŒŒë¼ë¯¸í„°ì—ì„œ ì§€ì—­ ì •ë³´ ì½ê¸°
  const urlParams = new URLSearchParams(window.location.search);
  const selectedRegion = urlParams.get('region') || 'ì„œìš¸ì‹œ ì „ì²´';
  
  // í˜ì´ì§€ ë¡œë“œ ì‹œ ì œëª© ì—…ë°ì´íŠ¸
  document.addEventListener('DOMContentLoaded', () => {
    const franchiseTitle = document.getElementById('franchise-title');
    if (franchiseTitle) {
      franchiseTitle.innerHTML = `${selectedRegion} í”„ëœì°¨ì´ì¦ˆë³„ ë¶„ì„`;
    }
    
    // KPI í´ë¦­ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
    const kpiElements = document.querySelectorAll('.kpi .v');
    
    kpiElements.forEach((element, index) => {
      element.addEventListener('click', function(event) {
        event.stopPropagation();
        event.preventDefault();
        const kpiTitle = this.parentElement.querySelector('.t').textContent;
        openAnalysisModal(index, kpiTitle);
      });
    });
  });
  
  // ëª¨ë‹¬ ì—´ê¸° í•¨ìˆ˜
  function openAnalysisModal(kpiIndex, title) {
    const modal = document.getElementById('analysisModal');
    const modalTitle = document.getElementById('modalTitle');
    const modalContent = document.getElementById('modalContent');
    
    // ëª¨ë‹¬ ì œëª© ì„¤ì •
    modalTitle.textContent = `${title} ìƒì„¸ ë¶„ì„`;
    
    // ë¡œë”© ìŠ¤í”¼ë„ˆ í‘œì‹œ
    modalContent.innerHTML = `
      <div class="loading-spinner">
        <div class="spinner"></div>
      </div>
    `;
    
    // ëª¨ë‹¬ í‘œì‹œ
    modal.classList.add('active');
    
    // API í˜¸ì¶œí•˜ì—¬ ë°ì´í„° ë¡œë“œ
    loadAnalysisData(kpiIndex, title);
  }
  
  // ëª¨ë‹¬ ë‹«ê¸° í•¨ìˆ˜
  function closeAnalysisModal() {
    const modal = document.getElementById('analysisModal');
    modal.classList.remove('active');
  }
  
  // ëª¨ë‹¬ ì™¸ë¶€ í´ë¦­ì‹œ ë‹«ê¸°
  document.getElementById('analysisModal').addEventListener('click', function(e) {
    if (e.target === this) {
      closeAnalysisModal();
    }
  });
  
  // ESC í‚¤ë¡œ ëª¨ë‹¬ ë‹«ê¸°
  document.addEventListener('keydown', function(e) {
    if (e.key === 'Escape') {
      closeAnalysisModal();
    }
  });
  
  // ë¶„ì„ ë°ì´í„° ë¡œë“œ í•¨ìˆ˜
  function loadAnalysisData(kpiIndex, title) {
    const params = new URLSearchParams();
    
    // í˜„ì¬ í•„í„° ì¡°ê±´ ì¶”ê°€
    if (selectedRegion && selectedRegion !== 'ì„œìš¸ì‹œ ì „ì²´') {
      params.append('region', selectedRegion);
    }
    
    // KPIë³„ API ì—”ë“œí¬ì¸íŠ¸ ê²°ì •
    let apiEndpoint = '';
    switch(kpiIndex) {
      case 0: // ì¹´í˜ ìˆ˜
        apiEndpoint = 'franchise_cafe_count_analysis';
        break;
      case 1: // í”„ëœì°¨ì´ì¦ˆ
        apiEndpoint = 'franchise_type_analysis';
        break;
      case 2: // ë§¤ì¶œì•¡
        apiEndpoint = 'franchise_sales_analysis';
        break;
      case 3: // í‰ê·  ì„±ì¥ë¥ 
        apiEndpoint = 'franchise_growth_analysis';
        break;
      default:
        apiEndpoint = 'franchise_cafe_count_analysis';
    }
    
    const apiUrl = `/api/cafes/cafes/${apiEndpoint}/?${params.toString()}`;
    console.log(`${title} ìƒì„¸ ë¶„ì„ API í˜¸ì¶œ:`, apiUrl);
    
    fetch(apiUrl)
      .then(response => {
        if (!response.ok) {
          throw new Error(`HTTP error! status: ${response.status}`);
        }
        return response.json();
      })
      .then(data => {
        console.log(`${title} ë¶„ì„ ë°ì´í„° ìˆ˜ì‹ :`, data);
        renderAnalysisData(data, kpiIndex, title);
      })
      .catch(error => {
        console.error(`${title} ë¶„ì„ ë°ì´í„° ë¡œë”© ì‹¤íŒ¨:`, error);
        showErrorMessage();
      });
  }
  
  // ë¶„ì„ ë°ì´í„° ë Œë”ë§ í•¨ìˆ˜
  function renderAnalysisData(data, kpiIndex, title) {
    const modalContent = document.getElementById('modalContent');
    let html = '';
    
    switch(kpiIndex) {
      case 0: // ì¹´í˜ ìˆ˜ ë¶„ì„
        html = renderCafeCountAnalysis(data);
        break;
      case 1: // í”„ëœì°¨ì´ì¦ˆ ë¶„ì„
        html = renderFranchiseTypeAnalysis(data);
        break;
      case 2: // ë§¤ì¶œì•¡ ë¶„ì„
        html = renderSalesAnalysis(data);
        break;
      case 3: // í‰ê·  ì„±ì¥ë¥  ë¶„ì„
        html = renderGrowthRateAnalysis(data);
        break;
    }
    
    modalContent.innerHTML = html;
  }
  
  // ì—ëŸ¬ ë©”ì‹œì§€ í‘œì‹œ í•¨ìˆ˜
  function showErrorMessage() {
    const modalContent = document.getElementById('modalContent');
    modalContent.innerHTML = `
      <div class="feed-card">
        <h3>âŒ ë°ì´í„° ë¡œë”© ì‹¤íŒ¨</h3>
        <div class="feed-content">
          ì£„ì†¡í•©ë‹ˆë‹¤. ë¶„ì„ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.
          ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ ì£¼ì„¸ìš”.
        </div>
      </div>
    `;
  }
  
  // ì¹´í˜ ìˆ˜ ë¶„ì„ ë Œë”ë§
  function renderCafeCountAnalysis(data) {
    return `
      <div class="feed-card">
        <h3>â˜• ì¹´í˜ ìˆ˜ ë¶„í¬ ë¶„ì„</h3>
        <div class="feed-meta">ì„ íƒëœ ì§€ì—­ì˜ ì¹´í˜ ë¶„í¬ í˜„í™©</div>
        
        <div class="highlight-stat">
          <span class="stat-label">ì´ ì¹´í˜ ìˆ˜</span>
          <span class="stat-value">${data.total_count || 0}ê°œ</span>
        </div>
        
        <div class="highlight-stat">
          <span class="stat-label">í”„ëœì°¨ì´ì¦ˆ ë¹„ìœ¨</span>
          <span class="stat-value">${data.franchise_ratio || 0}%</span>
        </div>
        
        <div class="highlight-stat">
          <span class="stat-label">ê°œì¸ì¹´í˜ ë¹„ìœ¨</span>
          <span class="stat-value">${data.individual_ratio || 0}%</span>
        </div>
      </div>
      
      <div class="feed-card">
        <h3>ğŸ“Š ê·œëª¨ë³„ ë¶„í¬</h3>
        <div class="feed-meta">ë§¤ì¥ ê·œëª¨ë³„ ì¹´í˜ ë¶„í¬</div>
        
        <ul class="trending-list">
          <li>
            <span>ëŒ€í˜• ë§¤ì¥ (50í‰ ì´ìƒ)</span>
            <span class="trend-up">${data.large_stores || 0}ê°œ</span>
          </li>
          <li>
            <span>ì¤‘í˜• ë§¤ì¥ (20-50í‰)</span>
            <span class="trend-up">${data.medium_stores || 0}ê°œ</span>
          </li>
          <li>
            <span>ì†Œí˜• ë§¤ì¥ (20í‰ ë¯¸ë§Œ)</span>
            <span class="trend-up">${data.small_stores || 0}ê°œ</span>
          </li>
        </ul>
      </div>
      
      <div class="feed-card">
        <h3>ğŸ“ˆ ì„±ì¥ ì¶”ì´</h3>
        <div class="feed-meta">ìµœê·¼ 3ë…„ê°„ ì¹´í˜ ìˆ˜ ë³€í™”</div>
        
        <div class="feed-content">
          ìµœê·¼ 3ë…„ê°„ í•´ë‹¹ ì§€ì—­ì˜ ì¹´í˜ ìˆ˜ëŠ” <strong>${data.growth_trend || 0}%</strong> ì¦ê°€í•˜ì˜€ìœ¼ë©°,
          íŠ¹íˆ í”„ëœì°¨ì´ì¦ˆ ì¹´í˜ê°€ <strong>${data.franchise_growth || 0}%</strong> ì¦ê°€í–ˆìŠµë‹ˆë‹¤.
        </div>
      </div>
    `;
  }
  
  // í”„ëœì°¨ì´ì¦ˆ íƒ€ì… ë¶„ì„ ë Œë”ë§
  function renderFranchiseTypeAnalysis(data) {
    return `
      <div class="feed-card">
        <h3>ğŸ¢ í”„ëœì°¨ì´ì¦ˆ ë¸Œëœë“œ ë¶„ì„</h3>
        <div class="feed-meta">ì£¼ìš” í”„ëœì°¨ì´ì¦ˆ ë¸Œëœë“œ í˜„í™©</div>
        
        <div class="highlight-stat">
          <span class="stat-label">í”„ëœì°¨ì´ì¦ˆ ë§¤ì¥ ìˆ˜</span>
          <span class="stat-value">${data.franchise_count || 0}ê°œ</span>
        </div>
        
        <div class="highlight-stat">
          <span class="stat-label">ê°œì¸ ë§¤ì¥ ìˆ˜</span>
          <span class="stat-value">${data.individual_count || 0}ê°œ</span>
        </div>
        
        <div class="highlight-stat">
          <span class="stat-label">ë¸Œëœë“œ ë‹¤ì–‘ì„±</span>
          <span class="stat-value">${data.brand_diversity || 0}ê°œ</span>
        </div>
      </div>
      
      <div class="feed-card">
        <h3>ğŸ¯ ìƒìœ„ ë¸Œëœë“œ</h3>
        <div class="feed-meta">ë§¤ì¥ ìˆ˜ ê¸°ì¤€ ìƒìœ„ í”„ëœì°¨ì´ì¦ˆ</div>
        
        <ul class="trending-list">
          ${(data.top_franchises || []).map(item => `
            <li>
              <span>${item.brand_name || 'ê¸°íƒ€'}</span>
              <span class="trend-up">${item.count || 0}ê°œ</span>
            </li>
          `).join('')}
        </ul>
      </div>
      
      <div class="feed-card">
        <h3>ğŸ“Š ì‹œì¥ ì ìœ ìœ¨</h3>
        <div class="feed-meta">í”„ëœì°¨ì´ì¦ˆ vs ê°œì¸ì¹´í˜</div>
        
        <div class="feed-content">
          ì„ íƒëœ ì§€ì—­ì—ì„œ í”„ëœì°¨ì´ì¦ˆê°€ ì „ì²´ ì¹´í˜ì˜ <strong>${data.franchise_market_share || 0}%</strong>ë¥¼ ì ìœ í•˜ê³  ìˆìœ¼ë©°,
          ê°œì¸ì¹´í˜ê°€ <strong>${data.individual_market_share || 0}%</strong>ë¥¼ ì°¨ì§€í•˜ê³  ìˆìŠµë‹ˆë‹¤.
        </div>
      </div>
    `;
  }
  
  // ë§¤ì¶œì•¡ ë¶„ì„ ë Œë”ë§
  function renderSalesAnalysis(data) {
    return `
      <div class="feed-card">
        <h3>ğŸ’° ë§¤ì¶œ í˜„í™© ë¶„ì„</h3>
        <div class="feed-meta">ì¶”ì • ë§¤ì¶œì•¡ ê¸°ë°˜ ë¶„ì„</div>
        
        <div class="highlight-stat">
          <span class="stat-label">ì´ ì¶”ì • ë§¤ì¶œ</span>
          <span class="stat-value">${data.total_sales || 0}ë§Œì›</span>
        </div>
        
        <div class="highlight-stat">
          <span class="stat-label">í‰ê·  ë§¤ì¶œ</span>
          <span class="stat-value">${data.avg_sales || 0}ë§Œì›</span>
        </div>
        
        <div class="highlight-stat">
          <span class="stat-label">ë§¤ì¶œ ì„±ì¥ë¥ </span>
          <span class="stat-value ${(data.sales_growth || 0) >= 0 ? '' : 'danger'}">${data.sales_growth || 0}%</span>
        </div>
      </div>
      
      <div class="feed-card">
        <h3>ğŸ“Š ë§¤ì¶œ êµ¬ê°„ë³„ ë¶„í¬</h3>
        <div class="feed-meta">ì›” ë§¤ì¶œ ê·œëª¨ë³„ ë§¤ì¥ ë¶„í¬</div>
        
        <ul class="trending-list">
          <li>
            <span>1000ë§Œì› ì´ìƒ</span>
            <span class="trend-up">${data.high_sales_stores || 0}ê°œ</span>
          </li>
          <li>
            <span>500-1000ë§Œì›</span>
            <span class="trend-up">${data.mid_sales_stores || 0}ê°œ</span>
          </li>
          <li>
            <span>300-500ë§Œì›</span>
            <span class="trend-up">${data.low_mid_sales_stores || 0}ê°œ</span>
          </li>
          <li>
            <span>300ë§Œì› ë¯¸ë§Œ</span>
            <span class="trend-down">${data.low_sales_stores || 0}ê°œ</span>
          </li>
        </ul>
      </div>
      
      <div class="feed-card">
        <h3>ğŸ¯ ë§¤ì¶œ ìš”ì¸ ë¶„ì„</h3>
        <div class="feed-meta">ë§¤ì¶œì— ì˜í–¥ì„ ë¯¸ì¹˜ëŠ” ì£¼ìš” ìš”ì¸</div>
        
        <div class="feed-content">
          <div style="margin-bottom: 16px;">
            <strong>ğŸŸ¢ ê¸ì • ìš”ì¸:</strong> ${data.positive_factors || 'ìœ ë™ì¸êµ¬ ì¦ê°€, ë¸Œëœë“œ ì¸ì§€ë„, ì ‘ê·¼ì„±'}
          </div>
          
          <div style="margin-bottom: 16px;">
            <strong>ğŸŸ¡ ì£¼ì˜ ìš”ì¸:</strong> ${data.caution_factors || 'ê²½ìŸ ì¦ê°€, ì„ëŒ€ë£Œ ìƒìŠ¹'}
          </div>
          
          <div>
            <strong>ğŸ”´ ë¶€ì • ìš”ì¸:</strong> ${data.negative_factors || 'ì‹œì¥ í¬í™”, ì†Œë¹„ íŒ¨í„´ ë³€í™”'}
          </div>
        </div>
      </div>
    `;
  }
  
  // ì„±ì¥ë¥  ë¶„ì„ ë Œë”ë§
  function renderGrowthRateAnalysis(data) {
    return `
      <div class="feed-card">
        <h3>ğŸ“ˆ ì„±ì¥ë¥  ë¶„ì„</h3>
        <div class="feed-meta">í”„ëœì°¨ì´ì¦ˆ ì„±ì¥ë¥  ìƒì„¸ ë¶„ì„</div>
        
        <div class="highlight-stat">
          <span class="stat-label">í‰ê·  ì„±ì¥ë¥ </span>
          <span class="stat-value">${data.avg_growth_rate || 0}%</span>
        </div>
        
        <div class="highlight-stat">
          <span class="stat-label">ì „ë…„ ë™ê¸° ëŒ€ë¹„</span>
          <span class="stat-value ${(data.yoy_change || 0) >= 0 ? '' : 'danger'}">${data.yoy_change || 0}%</span>
        </div>
        
        <div class="highlight-stat">
          <span class="stat-label">ì˜ˆìƒ ì„±ì¥ë¥ </span>
          <span class="stat-value">${data.predicted_growth || 0}%</span>
        </div>
      </div>
      
      <div class="feed-card">
        <h3>ğŸ† ì„±ì¥ë¥  ìƒìœ„ ë¸Œëœë“œ</h3>
        <div class="feed-meta">ì„±ì¥ë¥  ê¸°ì¤€ ìƒìœ„ í”„ëœì°¨ì´ì¦ˆ</div>
        
        <ul class="trending-list">
          ${(data.growth_leaders || []).map(item => `
            <li>
              <span>${item.brand_name || 'ê¸°íƒ€'}</span>
              <span class="${(item.growth_rate || 0) >= 0 ? 'trend-up' : 'trend-down'}">
                ${item.growth_rate || 0}%
              </span>
            </li>
          `).join('')}
        </ul>
      </div>
      
      <div class="feed-card">
        <h3>ğŸ” ì„±ì¥ ë™ë ¥ ë¶„ì„</h3>
        <div class="feed-meta">ì„±ì¥ë¥ ì— ì˜í–¥ì„ ë¯¸ì¹˜ëŠ” ìš”ì¸</div>
        
        <div class="feed-content">
          ì„ íƒëœ ì§€ì—­ì˜ í”„ëœì°¨ì´ì¦ˆ ì„±ì¥ë¥ ì€ <strong>${data.market_condition || 'ì•ˆì •ì '}</strong> ìƒíƒœì´ë©°,
          ì£¼ìš” ì„±ì¥ ë™ë ¥ì€ <strong>${data.growth_drivers || 'ë¸Œëœë“œ í™•ì¥, ë©”ë‰´ ë‹¤ì–‘í™”, ë§ˆì¼€íŒ… ê°•í™”'}</strong>ì…ë‹ˆë‹¤.
        </div>
      </div>
    `;
  }
</script>
</html>
