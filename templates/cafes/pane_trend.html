{% load static %}
<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>트렌드 분석</title>
  <link rel="stylesheet" href="{% static 'css/styles.css' %}">
</head>
<body>
  <div class="card tab-pane" id="pane-trend">
    <h3 id="trend-title">{{ selected_region }} 트렌드 분석</h3>
    <div class="grid-4 kpi-grid">
      <div class="kpi"><div class="t">3년 성장률</div><div class="v up">+{{ three_year_growth }}%</div><div class="s">예측 기반</div></div>
      <div class="kpi"><div class="t">신규 사업자</div><div class="v up">+{{ new_businesses }}</div><div class="s">성장 기대 지역</div></div>
      <div class="kpi"><div class="t">평균 생존율</div><div class="v">{{ survival_rate }}%</div></div>
      <div class="kpi"><div class="t">월 평균 매출 지수</div><div class="v">{{ sales_index }}</div><div class="s">기준=100</div></div>
    </div>

    <div class="bars">
      {% for category in trend_categories %}
      <div class="row">
        <div class="brand">{{ category.name }}</div>
        <div class="bar"><span style="width:{% widthratio category.growth_rate 200 100 %}%"></span></div>
        <div class="bar-meta">+{{ category.growth_rate }}% · {{ category.count }}개</div>
      </div>
      {% empty %}
      <div class="row"><div class="brand">필터 조건에 맞는 트렌드가 없습니다</div></div>
      {% endfor %}
    </div>
  </div>
</body>
<script type="text/javascript">
  // URL 파라미터에서 지역 정보 읽기
  const urlParams = new URLSearchParams(window.location.search);
  const selectedRegion = urlParams.get('region') || '서울시 전체';
  
  // 페이지 로드 시 제목 업데이트
  document.addEventListener('DOMContentLoaded', () => {
    const trendTitle = document.getElementById('trend-title');
    if (trendTitle) {
      trendTitle.innerHTML = `${selectedRegion} 트렌드 분석`;
    }
  });
</script>
</html>
